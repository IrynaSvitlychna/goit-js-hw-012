{"version":3,"file":"commonHelpers.js","sources":["../src/img/bi_x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__3108d0c6__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport xOctagon from \"/img/bi_x-octagon.svg\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from \"axios\";\n\n// const API_KEY = '77536933c9b583c79fa8689264f649aa4b326b2e';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    overlayOpacity: 0.5,\n  showCounter: false,\n    // captionsData: 'alt',\n    // captionDelay: 250,\n    // className: 'lightbox-on',\n  });\n\n// const errorOptions = {\n//     title: '',\n//     iconUrl: `${xOctagon}`,\n//     backgroundColor: '#EF4040',\n//     titleColor: '#fff',\n//     messageColor: '#fff',\n//     theme: 'dark',\n//     messageSize: '16px',\n//     progressBarColor: '#B5EA7C',\n//     position: 'topRight',\n//   }; \n\nconst API_KEY = '41942157-8ce243761fb563c2a1b85d8a4';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst searchingForm = document.querySelector('#form');\nconst searchInput = document.querySelector('#searchInput');\nconst searchButton = document.querySelector('.search-btn');\nconst gallery = document.querySelector('.gallery');\nconst loadImagesButton = document.querySelector('#loadBtn');\nconst loader = document.querySelector('.loader');\n\nlet scrollOffset = innerHeight;\nlet currentPage = 1;\nconst per_page = 40;\nlet userSearchRequest;\n\nwindow.scrollBy(0, scrollOffset);\n\nsearchingForm.addEventListener('submit', requestImages);\nloadImagesButton.addEventListener('click', loadMoreImages);\n\nasync function requestImages(e) {\n    e.preventDefault();\n    resetGallery();\n    userSearchRequest = searchInput.value;\n    await fetchAndRenderImages();\n  }\n\nasync function fetchAndRenderImages() {\n    try {\n      const response = await axios.get(API_BASE_URL, {\n        params: getAPIParams(),\n      });\n      const images = response.data;\n      if (images.hits.length === 0) {\n        showMessage(`There are no images matching your search query. Please try again!`);\n      }\n      galleryCreation(images.hits);\n      handleLoadMoreButton(images.totalHits);\n    } catch (error) {\n        showMessage('Oops... Something went wrong');\n    } finally {\n      loader.classList.add('hide');\n    }\n  }\n\n//  function requestImages(event) {\n//     event.preventDefault();\n//     gallery.innerHTML = '';\n//     addLoading();\n    \n//     const searchingOptions = new URLSearchParams({\n//         key: '41942157-8ce243761fb563c2a1b85d8a4',\n//         q: searchInput.value,\n//         orientation: 'horizontal',\n//         per_page: 40,\n//         image_type: 'photo',\n//         safesearch: true,\n//       });\n      \n//     fetch(`https://pixabay.com/api/?${searchingOptions}`)\n//     .then(response => {\n     \n//       return response.json();\n//     })\n//     .then(api => {\n//       const imagesArray = api.hits;\n//       if (imagesArray.length === 0) {\n//         throw new Error(\n//           `There are no images matching your search query. Please try again!`\n//         );\n//       }\n      \n//       galleryCreation(imagesArray);\n//       currentPage ++;\n//       removeLoading();\n//     })     \n//     .catch(error => {\n//       console.log(error);\n//       iziToast.error(\n//         errorOptions,\n//         (errorOptions.message = `Sorry! ${error.message}`)\n//       );\n//       removeLoading();\n//     });\n// }\n\n//  loadImagesButton.addEventListener(\"click\", requestImages);\n\n\nfunction galleryCreation(images) {\n    currentPage ++;\n    const markup = images.reduce(\n        (\n          html,\n          { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n        ) =>\n          html +\n          `\n          <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"image-desc\">\n              <div class=\"image-desc-item\">\n                <div class=\"image-desc-label\">Likes</div>\n                <div>${likes}</div>\n              </div>\n              <div class=\"image-desc-item\">\n                 <div class=\"image-desc-label\">Views</div>\n                 <div>${views}</div>\n              </div>\n              <div class=\"image-desc-item\">\n                <div class=\"image-desc-label\">Comments</div>\n                <div>${comments}</div>\n              </div>\n              <div class=\"image-desc-item\">\n                <div class=\"image-desc-label\">Downloads</div>\n                <div>${downloads}</div>\n              </div>\n            </div>\n          </li>\n          `,\n        ''\n      );\n\n    // const markup = images\n    //   .map(({  webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    //     return `<li class=\"gallery-item\"><div class='image-wrapper'>\n    // <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    //   <img\n    //     class=\"gallery-image\"\n    //     src=\"${webformatURL}\"\n    //     alt=\"${tags}\"\n    //     width=\"360\"\n    //     height=\"200\"\n    //   />\n    // </a>\n    // <div class=\"gallery-item-description\">\n    //     <ul class='gallery-item-description-list'>\n    //         <li class='gallery-description-list-item'>\n    //             <p class='description'>Likes</p>\n    //             <p class='quantity'>${likes}</p>\n    //         </li>\n    //         <li class='gallery-description-list-item'>\n    //             <p class='description'>Views</p>\n    //             <p class='quantity'>${views}</p>\n    //         </li>\n    //         <li class='gallery-description-list-item'>\n    //             <p class='description'>Comments</p>\n    //             <p class='quantity'>${comments}</p>\n    //         </li>\n    //         <li class='gallery-description-list-item'>\n    //             <p class='description'>Downloads</p>\n    //             <p class='quantity'>${downloads}</p>\n    //         </li>\n    //     </ul>\n    //   </div>\n    // </div>\n    // </li>`;\n    // })\n    //   .join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n    scrollOffset = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n    lightbox.refresh();\n  }\n\n  async function loadMoreImages() {\n    loadImagesButton.classList.add('hide');\n    loader.classList.remove('hide');\n    await fetchAndRenderImages();\n  }\n\n  function resetGallery() {\n    loadImagesButton.classList.add('hide');\n    loader.classList.remove('hide');\n    currentPage = 1;\n    gallery.innerHTML = '';\n  }\n\n  function getAPIParams() {\n    return {\n      key: API_KEY,\n      q: userSearchRequest,\n      orientation: 'horizontal',\n      image_type: 'photo',\n      safesearch: true,\n      currentPage,\n      per_page,\n    };\n  }\n\n  function handleLoadMoreButton(totalHits) {\n    const totalPages = Math.ceil(totalHits / per_page);\n    if (currentPage > totalPages) {\n      showMessage(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n        loadImagesButton.classList.remove('hide');\n    }\n  }\n\n  function showMessage(message) {\n    iziToast.show({\n      close: false, \n      iconUrl: `${xOctagon}`,\n      closeOnClick: true,\n      message,\n      messageColor: 'white',\n      timeout: 3000,\n      transitionIn: 'flipInX',\n      transitionOut: 'flipOutX',\n      position: 'topRight',\n      backgroundColor: 'red',\n      progressBar: false,\n    });\n  }\n\n//   function addLoading() {\n//     container.insertAdjacentHTML('afterbegin', '<div class=\"loader\"></div>');\n//     searchButton.disabled = true;\n//     searchButton.classList.add('search-btn-disabled');\n//   }\n\n//   function removeLoading() {\n//     const loader = document.querySelector('.loader');\n//     loader.remove();\n//     searchButton.disabled = false;\n//     searchButton.classList.remove('search-btn-disabled');\n//     searchingForm.reset();\n//   }\n \n\n    \n"],"names":["xOctagon","lightbox","SimpleLightbox","API_KEY","axios","searchingForm","searchInput","gallery","loadImagesButton","loader","scrollOffset","currentPage","per_page","userSearchRequest","requestImages","loadMoreImages","e","resetGallery","fetchAndRenderImages","images","getAPIParams","showMessage","galleryCreation","handleLoadMoreButton","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","totalHits","totalPages","message","iziToast"],"mappings":"owBAAA,MAAeA,EAAA,mDCYTC,EAAW,IAAIC,EAAe,aAAc,CAC9C,eAAgB,GAClB,YAAa,EAIf,CAAG,EAcGC,EAAU,qCAChBC,EAAM,SAAS,QAAU,2BAEzB,MAAMC,EAAgB,SAAS,cAAc,OAAO,EAC9CC,EAAc,SAAS,cAAc,cAAc,EACpC,SAAS,cAAc,aAAa,EACzD,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EAAe,YACfC,EAAc,EAClB,MAAMC,EAAW,GACjB,IAAIC,EAEJ,OAAO,SAAS,EAAGH,CAAY,EAE/BL,EAAc,iBAAiB,SAAUS,CAAa,EACtDN,EAAiB,iBAAiB,QAASO,CAAc,EAEzD,eAAeD,EAAcE,EAAG,CAC5BA,EAAE,eAAc,EAChBC,IACAJ,EAAoBP,EAAY,MAChC,MAAMY,EAAoB,CAC3B,CAEH,eAAeA,GAAuB,CAClC,GAAI,CAIF,MAAMC,GAHW,MAAMf,EAAM,IAAI,aAAc,CAC7C,OAAQgB,EAAc,CAC9B,CAAO,GACuB,KACpBD,EAAO,KAAK,SAAW,GACzBE,EAAY,mEAAmE,EAEjFC,EAAgBH,EAAO,IAAI,EAC3BI,EAAqBJ,EAAO,SAAS,CACtC,MAAC,CACEE,EAAY,8BAA8B,CAClD,QAAc,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACF,CA8CH,SAASa,EAAgBH,EAAQ,CAC7BR,IACA,MAAMa,EAASL,EAAO,OAClB,CACEM,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAExEP,EACA;AAAA;AAAA,uBAEaE;AAAA,0BACGD,WAAsBE;AAAA;AAAA;AAAA;AAAA;AAAA,uBAKzBC;AAAA;AAAA;AAAA;AAAA,wBAICC;AAAA;AAAA;AAAA;AAAA,uBAIDC;AAAA;AAAA;AAAA;AAAA,uBAIAC;AAAA;AAAA;AAAA;AAAA,YAKf,EACR,EAsCIzB,EAAQ,mBAAmB,YAAaiB,CAAM,EAC9Cd,EAAe,SACd,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OACzBT,EAAS,QAAO,CACjB,CAED,eAAec,GAAiB,CAC9BP,EAAiB,UAAU,IAAI,MAAM,EACrCC,EAAO,UAAU,OAAO,MAAM,EAC9B,MAAMS,EAAoB,CAC3B,CAED,SAASD,GAAe,CACtBT,EAAiB,UAAU,IAAI,MAAM,EACrCC,EAAO,UAAU,OAAO,MAAM,EAC9BE,EAAc,EACdJ,EAAQ,UAAY,EACrB,CAED,SAASa,GAAe,CACtB,MAAO,CACL,IAAKjB,EACL,EAAGU,EACH,YAAa,aACb,WAAY,QACZ,WAAY,GACZ,YAAAF,EACA,SAAAC,CACN,CACG,CAED,SAASW,EAAqBU,EAAW,CACvC,MAAMC,EAAa,KAAK,KAAKD,EAAYrB,CAAQ,EAC7CD,EAAcuB,EAChBb,EAAY,4DAA4D,EAEtEb,EAAiB,UAAU,OAAO,MAAM,CAE7C,CAED,SAASa,EAAYc,EAAS,CAC5BC,EAAS,KAAK,CACZ,MAAO,GACP,QAAS,GAAGpC,IACZ,aAAc,GACd,QAAAmC,EACA,aAAc,QACd,QAAS,IACT,aAAc,UACd,cAAe,WACf,SAAU,WACV,gBAAiB,MACjB,YAAa,EACnB,CAAK,CACF"}